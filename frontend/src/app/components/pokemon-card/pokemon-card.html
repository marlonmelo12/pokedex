<div
  class="group relative flex flex-col items-center bg-white rounded-2xl shadow-lg p-6 transition-transform duration-300 hover:scale-105 hover:shadow-xl">

  <div
    class="absolute top-3 right-3 z-10 flex flex-col gap-2 opacity-0 group-hover:opacity-100 transition-opacity duration-300">

    <button
      type="button"
      (click)="onToggleFavorite($event)"
      class="w-8 h-8 rounded-full flex items-center justify-center bg-white/80 backdrop-blur-sm shadow-md hover:scale-110 transition-transform"
      [attr.aria-label]="pokemon.favorito ? 'Remover dos favoritos' : 'Adicionar aos favoritos'">
      <mat-icon [class.text-red-500]="pokemon.favorito">
        {{ pokemon.favorito ? 'favorite' : 'favorite_border' }}
      </mat-icon>
    </button>

    <button
      type="button"
      (click)="onToggleBattleTeam($event)"
      class="w-8 h-8 rounded-full flex items-center justify-center bg-white/80 backdrop-blur-sm shadow-md hover:scale-110 transition-transform"
      [attr.aria-label]="pokemon.grupo_batalha ? 'Remover da equipe' : 'Adicionar à equipe'">
      <mat-icon [class.text-blue-500]="pokemon.grupo_batalha">
        {{ pokemon.grupo_batalha ? 'check_circle' : 'add_circle_outline' }}
      </mat-icon>
    </button>
  </div>

  <div class="w-full flex justify-between items-center mb-2">
    <span class="text-gray-500 font-bold">#{{ pokemon.codigo }}</span>
    <div class="flex gap-2">
      @for (type of pokemon.types; track type.descricao) {
        <span
          class="px-2 py-1 text-xs text-white rounded-full"
          [ngClass]="{
            'bg-green-500': type.descricao === 'Grass',
            'bg-purple-500': type.descricao === 'Poison',
            'bg-red-500': type.descricao === 'Fire',
            'bg-blue-500': type.descricao === 'Water',
            'bg-indigo-500': type.descricao === 'Flying',
            'bg-lime-500': type.descricao === 'Bug',
            'bg-gray-400': !typeColorMap[type.descricao]
          }">
          {{ type.descricao }}
        </span>
      }
    </div>
  </div>

  <div class="bg-gray-100 w-full rounded-xl flex justify-center p-4 mb-4">
    <img [src]="pokemon.imageUrl" [alt]="pokemon.name" class="w-32 h-32 object-contain">
  </div>

  <h3 class="text-2xl font-bold mb-4 text-center capitalize">{{ pokemon.name }}</h3>

  <div class="w-full text-sm space-y-2">
    @for (stat of pokemonStats; track stat.name) {
      <div class="flex items-center gap-2">
        <span class="w-16 font-semibold capitalize">{{ stat.name }}</span>
        <span class="w-8 text-right font-bold">{{ stat.value }}</span>
        <div class="flex-1 bg-gray-200 rounded-full h-2 overflow-hidden">
          <div
            class="bg-green-500 h-2 rounded-full transition-all duration-500 ease-out"
            [style.width.%]="Math.min(stat.value, 100)">
          </div>
        </div>
      </div>
    }
  </div>

  <div
    class="w-full grid grid-rows-[0fr] data-[expanded=true]:grid-rows-[1fr] transition-all duration-500 ease-in-out"
    [attr.data-expanded]="isExpanded">
    <div class="overflow-hidden">
      <div class="pt-6 border-t mt-6">
        <h4 class="font-bold mb-2">Descrição</h4>
        <p class="text-sm text-gray-600 mb-4">{{ pokemon.description }}</p>

        <h4 class="font-bold mb-2">Habilidades</h4>
        <div class="flex flex-wrap gap-2">
          @for (ability of pokemon.abilities; track ability) {
            <span
              class="bg-gray-200 text-gray-700 text-xs font-semibold px-2.5 py-1 rounded-full">
              {{ ability }}
            </span>
          }
        </div>
      </div>
    </div>
  </div>
</div>